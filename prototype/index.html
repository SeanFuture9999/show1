<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>ÈáçÁîüÊäΩÂç°Âæ©‰ªáË®ò ‚Äî Ïù¥Î≤à ÏÉùÏóêÏÑúÎäî</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&family=Noto+Sans+KR:wght@400;700&display=swap');

* { margin:0; padding:0; box-sizing:border-box; }
html, body { width:100%; height:100%; }
body { background:#000; overflow:hidden; font-family:'Noto Sans TC','Noto Sans KR','Microsoft JhengHei',sans-serif; }

#game {
  position:relative; width:100%; height:100%;
  max-width:800px; margin:0 auto;
  background:#0a0a1a; overflow:hidden;
  /* image-rendering: pixelated; -- disabled for Gemini HD art */
}

/* Background */
#bg {
  position:absolute; top:0; left:0; width:100%; height:65%;
  background-size:cover; background-position:center;
  transition: opacity 0.8s ease;
  filter: brightness(0.85) contrast(1.1);
}

/* Vignette overlay */
#vignette {
  position:absolute; top:0; left:0; width:100%; height:65%;
  background: radial-gradient(ellipse at center, transparent 50%, rgba(0,0,0,0.6) 100%);
  z-index:2; pointer-events:none;
  transition: opacity 1s ease;
}

/* Characters */
.char-slot {
  position:absolute; bottom:35%; width:40%;
  z-index:5;
  filter: drop-shadow(0 4px 12px rgba(0,0,0,0.8));
}
#char-left { left:0%; }
#char-center { left:30%; }
#char-right { right:0%; }
.char-slot img { width:100%; display:none; object-fit:contain; }

/* CG overlay */
#cg-overlay {
  position:absolute; top:0; left:0; width:100%; height:70%;
  display:none; z-index:10;
  background-size:cover; background-position:center top; background-repeat:no-repeat;
  filter: brightness(0.9) contrast(1.15);
}

/* Dialogue box */
#dialogue {
  position:absolute; bottom:0; left:0; width:100%;
  min-height:35%; max-height:42%;
  background: linear-gradient(180deg, rgba(5,5,20,0.88) 0%, rgba(5,5,20,0.98) 100%);
  border-top: 3px solid #c9a94e;
  padding: 20px 28px 16px;
  z-index:20;
  backdrop-filter: blur(4px);
}

/* Speaker name */
#speaker {
  color:#c9a94e; 
  font-size: 20px; 
  font-weight:700;
  margin-bottom:10px; 
  letter-spacing:2px;
  text-shadow: 0 0 10px rgba(201,169,78,0.4);
}

/* Main text */
#text {
  color:#e8e8e8; 
  font-size: 20px; 
  line-height: 1.8;
  min-height:80px;
  text-shadow: 0 1px 3px rgba(0,0,0,0.5);
}
#text .highlight { 
  color:#ff6b6b; font-weight:bold; 
  text-shadow: 0 0 8px rgba(255,107,107,0.5);
}
#text .korean { 
  color:#c9a94e; font-style:italic; 
  text-shadow: 0 0 6px rgba(201,169,78,0.3);
}
#text .system { 
  color:#4ecdc4; 
  text-shadow: 0 0 8px rgba(78,205,196,0.4);
}

/* Narration ‚Äî Ê∏ÖÊô∞ÁôΩÂ≠óÔºå‰∏çÊñúÈ´îÔºåË∑üÂ∞çÁôΩÂêåÁ≠âÈáçË¶Å */
.narration { border-top-color:#8888aa !important; }
.narration #speaker { display:none !important; }
.narration #text { 
  color:#ffffff !important; 
  font-style:normal !important; 
  font-size:20px !important;
  line-height:1.8 !important;
  letter-spacing:0.5px;
}

/* Click indicator */
#click-indicator {
  position:absolute; bottom:12px; right:24px;
  color:#c9a94e; font-size:15px; opacity:0.7;
  animation: blink 1.2s infinite;
  letter-spacing:1px;
  background: url('assets/ui/click_arrow.png') left center/16px 16px no-repeat;
  image-rendering: pixelated;
  padding-left:22px;
}

/* Choices */
#choices {
  position:absolute; bottom:38%; left:50%; transform:translateX(-50%);
  display:none; flex-direction:column; gap:14px; z-index:30;
  width:80%; max-width:500px;
}
.choice-btn {
  background: rgba(10,10,26,0.92); 
  border:2px solid #c9a94e;
  color:#e0e0e0; padding:16px 24px; 
  font-size:18px;
  cursor:pointer; transition:all 0.3s;
  font-family:inherit; text-align:center;
  border-radius:6px;
  backdrop-filter:blur(4px);
  border-image: url('assets/ui/btn_normal.png') 8 fill / 8px / 0 stretch;
  image-rendering: pixelated;
}
.choice-btn:hover { 
  background:#c9a94e; color:#0a0a1a; 
  transform:scale(1.03);
  box-shadow: 0 0 20px rgba(201,169,78,0.5);
}
.choice-btn.endure { 
  border-color:#4ecdc4;
  border-image: url('assets/ui/btn_endure.png') 8 fill / 8px / 0 stretch;
}
.choice-btn.endure:hover { background:#4ecdc4; box-shadow: 0 0 20px rgba(78,205,196,0.5); }
.choice-btn.strike { 
  border-color:#ff6b6b; opacity:0.35; cursor:not-allowed;
  border-image: url('assets/ui/btn_disabled.png') 8 fill / 8px / 0 stretch;
}

/* Arrogance meter */
#arrogance-bar {
  position:absolute; top:14px; right:14px;
  width:200px; height:24px;
  background: url('assets/ui/arrogance_frame.png') center/100% 100% no-repeat;
  image-rendering: pixelated;
  z-index:25; display:none;
  overflow:hidden; padding:3px;
}
#arrogance-fill {
  height:100%; 
  background:linear-gradient(90deg,#ff6b6b,#ff2222);
  width:0%; transition:width 0.6s ease;
}
#arrogance-label {
  position:absolute; top:-22px; right:0;
  color:#ff6b6b; font-size:12px; letter-spacing:1px;
  white-space:nowrap;
  transition: all 0.3s;
}

/* ===== GACHA SYSTEM ===== */
#gacha-overlay {
  position:absolute; top:0; left:0; width:100%; height:100%;
  background:rgba(0,0,0,0.97); display:none; z-index:50;
  justify-content:center; align-items:center; flex-direction:column;
}
.gacha-stage {
  display:flex; flex-direction:column; align-items:center; justify-content:center;
  width:100%; height:100%; position:absolute; top:0; left:0;
}

/* Stage 1: Charge */
#gacha-watch-icon {
  font-size:80px; animation: watchPulse 1s ease infinite;
  filter: drop-shadow(0 0 20px rgba(201,169,78,0.8));
  background: url('assets/ui/watch_icon.png') center/contain no-repeat;
  image-rendering: pixelated;
  width:96px; height:96px; display:inline-block;
}
#gacha-charge-text {
  color:#c9a94e; font-size:18px; margin-top:20px; letter-spacing:2px;
}
#gacha-charge-bar {
  width:60%; max-width:300px; height:8px; margin-top:16px;
  border:2px solid #c9a94e; border-radius:4px; overflow:hidden;
  background:rgba(0,0,0,0.5);
}
#gacha-charge-fill {
  height:100%; width:0%; background:linear-gradient(90deg,#4ecdc4,#c9a94e,#ff6b6b);
  transition: width 0.15s;
}
#gacha-tap-hint {
  color:#ff6b6b; font-size:22px; font-weight:bold; margin-top:24px;
  animation: blink 0.6s infinite; letter-spacing:3px;
}

/* Stage 2: Spinning cards */
#gacha-cards-row {
  display:flex; gap:20px; margin-bottom:30px;
}
.gacha-candidate {
  width:80px; height:120px; border:2px solid #555;
  background: url('assets/ui/card_back.png') center/cover no-repeat;
  image-rendering: pixelated;
  display:flex; align-items:center; justify-content:center;
  font-size:32px; border-radius:8px;
  animation: cardFloat 0.8s ease infinite;
}
.gacha-candidate:nth-child(1) { animation-delay:0s; }
.gacha-candidate:nth-child(2) { animation-delay:0.2s; }
.gacha-candidate:nth-child(3) { animation-delay:0.4s; }
.gacha-candidate.chosen {
  border-color:#c9a94e !important; transform:scale(1.3);
  box-shadow: 0 0 30px rgba(201,169,78,0.8);
  animation: none;
}
.gacha-candidate.dimmed { opacity:0.2; transform:scale(0.8); animation:none; }
#gacha-spin-text {
  color:#999; font-size:16px; animation: blink 0.5s infinite;
}

/* Stage 3: Reveal */
#gacha-reveal-burst {
  position:absolute; width:300px; height:300px; border-radius:50%;
  background: radial-gradient(circle, rgba(201,169,78,0.4) 0%, transparent 70%);
  animation: burstExpand 1s ease forwards;
}
#gacha-card {
  width:160px; height:220px; border:none;
  background: url('assets/ui/card_frame_r.png') center/cover no-repeat;
  image-rendering: pixelated;
  display:flex; align-items:center; justify-content:center;
  color:#c9a94e; font-size:48px; margin-bottom:16px;
  border-radius:10px;
  box-shadow: 0 0 40px rgba(201,169,78,0.5);
  animation: cardReveal 0.8s ease forwards;
  z-index:2;
}
#gacha-rarity {
  font-size:20px; letter-spacing:4px; margin-bottom:8px; font-weight:bold; z-index:2;
}
#gacha-card-name {
  font-size:24px; color:#fff; font-weight:bold; margin-bottom:12px;
  text-shadow: 0 0 10px rgba(255,255,255,0.3); z-index:2;
}
#gacha-card-desc {
  font-size:15px; color:#bbb; max-width:80%; text-align:center;
  line-height:1.7; z-index:2;
}
#gacha-close {
  margin-top:28px; padding:14px 50px;
  background:transparent; border:2px solid #c9a94e;
  color:#c9a94e; cursor:pointer; font-family:inherit;
  font-size:18px; border-radius:6px; transition:all 0.3s;
  z-index:2; letter-spacing:2px;
}
#gacha-close:hover { background:#c9a94e; color:#0a0a1a; }

/* Gacha Animations */
@keyframes watchPulse {
  0%,100% { transform:scale(1); filter: drop-shadow(0 0 20px rgba(201,169,78,0.5)); }
  50% { transform:scale(1.15); filter: drop-shadow(0 0 40px rgba(201,169,78,1)); }
}
@keyframes cardFloat {
  0%,100% { transform:translateY(0); }
  50% { transform:translateY(-10px); }
}
@keyframes burstExpand {
  0% { transform:scale(0); opacity:1; }
  100% { transform:scale(3); opacity:0; }
}

/* Screen effects */
#screen-flash {
  position:absolute; top:0; left:0; width:100%; height:100%;
  background:#fff; opacity:0; z-index:100; pointer-events:none;
  transition: opacity 0.15s;
}
#screen-shake { position:relative; width:100%; height:100%; }

/* Title screen */
#title-screen {
  position:absolute; top:0; left:0; width:100%; height:100%;
  background:linear-gradient(180deg,#050515 0%,#1a0a2a 50%,#0a0a1a 100%);
  display:flex; flex-direction:column; align-items:center; justify-content:center;
  z-index:200;
  transition: opacity 0.8s ease;
}
#title-screen h1 {
  color:#c9a94e; font-size:36px; margin-bottom:12px; letter-spacing:6px;
  font-weight:900;
  text-shadow: 0 0 30px rgba(201,169,78,0.5);
  animation: titleGlow 3s ease infinite;
}
#title-screen h2 {
  color:#ff6b6b; font-size:22px; margin-bottom:50px; font-weight:normal;
  letter-spacing:3px;
}
#title-screen .subtitle {
  color:#777; font-size:16px; margin-bottom:50px; font-style:italic;
  letter-spacing:2px;
}
#start-btn {
  padding:18px 70px; background:transparent; border:2px solid #c9a94e;
  color:#c9a94e; font-size:22px; cursor:pointer; font-family:inherit;
  letter-spacing:6px; transition:all 0.3s; border-radius:6px;
}
#start-btn:hover { 
  background:#c9a94e; color:#0a0a1a; 
  box-shadow: 0 0 30px rgba(201,169,78,0.6);
}

/* ===== ANIMATIONS ===== */
@keyframes blink { 0%,100%{opacity:0.3} 50%{opacity:1} }
@keyframes fadeIn { from{opacity:0} to{opacity:1} }

@keyframes cgReveal {
  0% { opacity:0; transform:scale(1.1); filter:brightness(2); }
  50% { opacity:1; filter:brightness(1.5); }
  100% { opacity:1; transform:scale(1); filter:brightness(0.9) contrast(1.15); }
}
@keyframes cgFadeOut {
  from { opacity:1; } to { opacity:0; }
}

@keyframes charAppear {
  0% { opacity:0; transform:translateY(20px); }
  100% { opacity:1; transform:translateY(0); }
}

@keyframes cardSpin {
  0% { transform:rotateY(0deg) scale(0.9); }
  50% { transform:rotateY(180deg) scale(1.05); }
  100% { transform:rotateY(360deg) scale(0.9); }
}
@keyframes cardReveal {
  0% { transform:scale(0.5) rotateY(180deg); opacity:0; }
  60% { transform:scale(1.15) rotateY(0deg); opacity:1; }
  100% { transform:scale(1) rotateY(0deg); opacity:1; }
}

@keyframes shakeX {
  0%,100% { transform:translateX(0) }
  10% { transform:translateX(-8px) }
  30% { transform:translateX(8px) }
  50% { transform:translateX(-6px) }
  70% { transform:translateX(6px) }
  90% { transform:translateX(-3px) }
}
.shake { animation: shakeX 0.4s ease; }

@keyframes pulseRed {
  0%,100% { box-shadow:none; }
  50% { box-shadow: 0 0 20px rgba(255,0,0,0.6); border-color:#ff0000; }
}
.pulse-red { animation: pulseRed 0.6s ease; }

@keyframes titleGlow {
  0%,100% { text-shadow: 0 0 20px rgba(201,169,78,0.3); }
  50% { text-shadow: 0 0 40px rgba(201,169,78,0.7), 0 0 60px rgba(201,169,78,0.3); }
}

/* Scanline effect for atmosphere */
#game::after {
  content:'';
  position:absolute; top:0; left:0; width:100%; height:100%;
  background: repeating-linear-gradient(
    0deg, transparent, transparent 2px, rgba(0,0,0,0.03) 2px, rgba(0,0,0,0.03) 4px
  );
  pointer-events:none; z-index:150;
}
</style>
</head>
<body>
<div id="game">
  <!-- Title Screen -->
  <div id="title-screen">
    <h1>ÈáçÁîüÊäΩÂç°Âæ©‰ªáË®ò</h1>
    <h2>Ïù¥Î≤à ÏÉùÏóêÏÑúÎäî</h2>
    <div class="subtitle">‚Äî ÈÄô‰∏Ä‰∏ñÔºåËº™Âà∞‰Ω†Ë∑™‰∫Ü ‚Äî</div>
    <button id="start-btn" onclick="startGame()">START</button>
  </div>

  <div id="screen-shake">
    <div id="bg"></div>
    <div id="vignette"></div>
    <div id="cg-overlay"></div>
    <div id="char-left" class="char-slot"><img src="" style="display:none"></div>
    <div id="char-center" class="char-slot"><img src="" style="display:none"></div>
    <div id="char-right" class="char-slot"><img src="" style="display:none"></div>
  </div>

  <!-- Arrogance Meter -->
  <div id="arrogance-bar">
    <div id="arrogance-label">ÂõÇÂºµÂÄº</div>
    <div id="arrogance-fill"></div>
  </div>

  <!-- Dialogue -->
  <div id="dialogue" style="display:none">
    <div id="speaker"></div>
    <div id="text"></div>
    <div id="click-indicator">‚ñº ÈªûÊìäÁπºÁ∫å</div>
  </div>

  <!-- Choices -->
  <div id="choices"></div>

  <!-- Gacha -->
  <div id="gacha-overlay">
    <div id="gacha-stage1" class="gacha-stage">
      <div id="gacha-watch-icon">‚è±Ô∏è</div>
      <div id="gacha-charge-text">Êá∑Èå∂Ê≠£Âú®Âê∏Êî∂ÂõÇÂºµ‰πãÊ∞£...</div>
      <div id="gacha-charge-bar"><div id="gacha-charge-fill"></div></div>
      <div id="gacha-tap-hint">ÈªûÊìäËìÑÂäõÔºÅ</div>
    </div>
    <div id="gacha-stage2" class="gacha-stage" style="display:none">
      <div id="gacha-cards-row">
        <div class="gacha-candidate">üé¥</div>
        <div class="gacha-candidate">üé¥</div>
        <div class="gacha-candidate">üé¥</div>
      </div>
      <div id="gacha-spin-text">ÂëΩÈÅã‰πãËº™ËΩâÂãï‰∏≠...</div>
    </div>
    <div id="gacha-stage3" class="gacha-stage" style="display:none">
      <div id="gacha-reveal-burst"></div>
      <div id="gacha-card">?</div>
      <div id="gacha-rarity"></div>
      <div id="gacha-card-name"></div>
      <div id="gacha-card-desc"></div>
      <button id="gacha-close" onclick="closeGacha()">Êî∂‰∏ã</button>
    </div>
  </div>

  <!-- Effects -->
  <div id="screen-flash"></div>
</div>

<script src="data/prologue.js"></script>
<script src="scripts/engine.js"></script>
</body>
</html>
